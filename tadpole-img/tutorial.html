<div class="row">
  <div class="span12">
    <div id="0" class="step" style="display:none">
      <h2>FrackFinder - Drilling site classification</h2>
      <p><strong>Hi!</strong> This is a project to classify images of sites where drilling and fracking has occured or will occur in the future.</p>
      <p>The task is really simple. You will see an image showing an overhead view of a drilling site.  Based on what you can see, we will ask you to select the category that best describes it.</p>
      <p>First we'll show you a few examples so you can see what the categories are.</p>
    </div>

    <div id="3" class="step" style="display:none">
      <p>This is a site where drilling equipment is present, indicating that drilling activity was taking place at the time the image was captured. For our purposes, &quot;Equipment&quot; means more than just a few trucks parked on the pad - we're looking for many trucks and other large equipment.   If you're not sure how much equipment is enough, then just make your best guess and move on.</p>
      <p>For images like this, please indicate that there is <button class="btn btn-danger" href="#" onclick="showStep('next')">Pad with equipment</button> present.</p>

      <div class="row">
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/well+pads+w_equipment/2010tioga_spudbuffer11.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/well+pads+w_equipment/2010tioga_spudbuffer34.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/well+pads+w_equipment/2008_X-079.3670_Y0040.6300.png" class="img-polaroid">
        </div>
      </div>
    </div>

    <div id="2" class="step" style="display:none">
      <p>This is a site where a well pad has been prepared for drilling, but there was no drilling equipment on site at the time the image was captured. A bare pad will be roughly rectangular and appear close to the center of the image, with an access road visible and partially or completely clear of vegetation. Usually they are covered in bare dirt or gravel. You may also see an artificial water storage pond.</p>
      <p>For images like this, please indicate that there is a <button class="btn btn-answer" href="#" onclick="showStep('next')">Bare pad</button></p>

      <div class="row">
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/empty+well+pads/2010_X-076.9908_Y0041.9884.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/empty+well+pads/2010tioga_spudbuffer21.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/empty+well+pads/2010tioga_spudbuffer44.png" class="img-polaroid">
        </div>
      </div>
    </div>

    <div id="1" class="step" style="display:none">
      <p>This is a site where a drilling permit has been issued but no preparation for drilling has taken place yet.  Sometimes you may see a clearing in the forest which might look like a drilling area, but if you don't see an access road, then it is not a drill pad. Also, if the cleared area is not close to the center of the image, then it does not count either.</p>
      <p>For images like this, please indicate that there is <button class="btn btn-success" href="#" onclick="showStep('next')">No pad visible</button></p>

      <div class="row">
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/no+pad+visible/2010tioga_spudbuffer136.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/no+pad+visible/2010_X-079.2094_Y0041.5985.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/no+pad+visible/2010tioga_spudbuffer142.png" class="img-polaroid">
        </div>
      </div>
    </div>

    <div id="4" class="step" style="display:none">
      <p>For some images, you just can't say for sure what's going on. In that case, we give you a &quot;Don't Know&quot; button so you can move on and leave the hard ones to us to figure out. In some cases, you may have a large cleared area in the center of the image, but it's too large and not rectangular, like the first two examples here.  Or you may have something in the right place and about the right size and shape, but based on the context it looks more like a farm or residential area, like in the third image.</p>
      <p>In cases like this, or anything else that just looks weird, click <button class="btn btn-inverse" href="#" onclick="showStep('next')">Don't know</button></p>

      <div class="row">
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/unknown/2008_X-079.6266_Y0040.7788.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/unknown/2008_X-079.5392_Y0040.8886.png" class="img-polaroid">
        </div>
        <div class="span4">
          <img src="https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/unknown/2008_X-079.5970_Y0040.7876.png" class="img-polaroid">
        </div>
      </div>
    </div>

    <div id="5" class="step" style="display:none">
      <h2>Practice run</h2>
      
      {% include "tadpole-img/row.html" %}

      <span id="maperrors"></span>
    </div>

    <div id="6" class="step" style="display:none">
      <h2>On your mark, get set, go!</h2>
      <p>Great! You're ready to start contributing to the project!</p>
      <p>Whether you can give us 5 minutes or 50, any contribution will help us reach our goal, so do as much as you can now, and you can always come back later if you want some more.</p>
      <p>Click Previous now if you want to go back and review.  Otherwise click Start and dive right in!</p>
    </div>

    <div class="navigation">
      <a id="prevBtn" href="#" onclick="showStep('prev')" class="btn">Previous</a>
      <a id="nextBtn" href="#" onclick="showStep('next')" class="btn btn-success">Next</a>
      <a id="startContrib" href="../{{short_name}}/newtask" class="btn btn-primary" style="display:none"><i class="icon-thumbs-up"></i> Start helping out</a>
    </div>
    <div>
    <a id="skipBtn" href="../{{short_name}}/newtask">No thanks, I've done this before. I'm ready to start</a>
    </div>
  </div>
</div>

<!--style>
  .navigation {
   margin-top: 10px;
  }
  #maperrors {
    color: #ff0000;
    font-weight: bold;
  }
  #start {
    display: none;
  }

  .item {
    margin-top: 4pt;
    margin-bottom: 4pt;
  }
  .progress {
    width: 50px;
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  #center {
    display: table;
    width: 100%
  }
  #centerinner {
    display: table-cell;
    text-align: center;
    vertical-align: middle;
  }
  #mapborder {
    border: 2px solid #999999;
    display: inline-block;
    padding: 5pt;
    margin: 20pt;
  }

</style-->

<style>
  #start {
    display: none;
  }
  .answer-buttons .btn {
    margin-bottom: 2pt;
    width: 120pt;
    text-align: left;
  }
  .image {
    -webkit-border-radius: 8pt;
    -moz-border-radius: 8pt;
    border-radius: 8pt;
  	position:absolute;
  	z-index:0;
  }
  .imgoverlay {
  	position:absolute;
  	z-index:1;
  }
</style>


<script src="http://openlayers.org/dev/OpenLayers.js"></script>
<script src="http://maps.google.com/maps/api/js?v=3&amp;sensor=false"></script>

<script>
  {% include "tadpole-img/maphandler.js" %}

  testrunstep = 5;
  laststep = 6;
  
  testruns = [
      {"url":"https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/empty+well+pads/2010tioga_spudbuffer16.png", "answer":"empty", "latitude": 41.9063, "longitude": -76.9252, "year": "2010", "county":"Tioga", "siteID": "def69ddd-d528-53f3-aa69-60ee4e4fe1a8"},
    {"url":"https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/no+pad+visible/2010tioga_spudbuffer139.png", "answer":"nopad", "latitude": 41.6453, "longitude": -77.2906, "year": "2010", "county":"Tioga", "siteID": "f0137364-26ef-5ff7-960d-69f92d7b45cc"},
    {"url":"https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/empty+well+pads/2010_X-077.1201_Y0041.6894.png", "answer":"empty", "latitude": 41.6894, "longitude": -77.1201, "year": "2010", "county":"Tioga", "siteID": "cf151868-e99b-5b54-849c-fcf59a354462"},
    {"url":"https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/unknown/2008_X-079.4211_Y0040.8858.png", "answer":"unknown", "latitude": 40.8858, "longitude": -79.4211, "year": "2008", "county":"Tioga", "siteID": "f258d929-b41b-53f7-8f53-8b3f2524e255"},
    {"url":"https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/well+pads+w_equipment/2010tioga_spudbuffer40.png", "answer":"equipment", "latitude": 41.6886, "longitude": -77.5275, "year": "2010", "county":"Tioga", "siteID": "a14c83a0-0986-552a-bc33-8520d640871e"},
    {"url":"https://s3.amazonaws.com/FrackFinder/Tadpole/well+pad+examples/no+pad+visible/2008_X-076.3320_Y0041.2842.png", "answer":"nopad", "latitude": 41.2842, "longitude": -76.3320, "year": "2008", "county":"Columbia", "siteID": "c5ee0173-5c21-5932-9f33-af891bf2c0e0"},
  ];

  initializedSteps = {};
  function initializeStep(step) {
    if (initializedSteps[step] == undefined) {
      if (step == testrunstep) {
        initializedSteps[step] = {task:0};

        loadMap();
        setProgress({total: testruns.length, done:0});
        updateMap(testruns[0]);
      } else {
        initializedSteps[step] = true;
      }
    }
  }

  function validateStep() {
    var errs = [];
    if (step == testrunstep) {
      if (initializedSteps[testrunstep].task < testruns.length) {
        errs.push("This should not happen. Where did you click?");
      }
    }
    $("#maperrors").html(errs.join(""));
    return errs.length == 0;
  }


  var step = -1;
  function showStep(action) {
    if (action == 'next' && !validateStep()) return;

    $("#" + step).hide();

    if (action == 'next') {
      step = step + 1;
    }
    if (action == 'prev') {
      step = step - 1;
    }

    $("#prevBtn").toggle(step != 0);
    $("#skipBtn").toggle(step == 0);
    $("#nextBtn").toggle(step != testrunstep && step != laststep);
    $("#startContrib").toggle(step == laststep);
    $("#" + step).show();
    initializeStep(step);
  }


  $(document).ready(function () {
    showStep('next');
    $("#modal").modal('show');

    $(".btn-answer").click(function (e) {
      if (testruns[initializedSteps[testrunstep].task].answer == e.target.value) {
        initializedSteps[testrunstep].task++;
        if (initializedSteps[testrunstep].task < testruns.length) {
          setProgress({total: testruns.length, done:initializedSteps[testrunstep].task});
          updateMap(testruns[initializedSteps[testrunstep].task]);
        } else {
          showStep('next');
          initializedSteps[testrunstep].task = 0;
          setProgress({total: testruns.length, done:initializedSteps[testrunstep].task});
          updateMap(testruns[initializedSteps[testrunstep].task]);
        } 
      } else {
        alert("Sorry, that's not what's show in this picture :( Please try again!");
      }
    });
    $('.input-answer').on('keypress', function(evt) {
      if (evt.which == 13) {
        alert("In this prectice round, all tasks should fall neatly into one of the categories. Nice try though :)");
        evt.target.value = '';
      }
    });
  });
</script>
